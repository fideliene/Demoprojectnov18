this code is by Marc
